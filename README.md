# ros_georegistration

ros_georegistration is a georegistration simulator built around ROS. 
It is intended to test georegistration algorithms by comparing the pose of the
plane generated by the algorithms with the ground truth pose generated from the 
simulator.


## Getting Started
Install the latest version of ROS for your computer.

Install the following python modules:

* NumPy:
`pip install numpy`

* SciPy:
`pip install scipy`

* OpenCV:
`pip install opencv-python==3.4.2.17`

* OpenCV's extra modules: 
`pip install opencv-contrib-python==3.4.2.17`

Use the following repositories in your ROS workspace:

* [ROSplane](https://github.com/byu-magicc/rosplane)
* [ROScopter](https://github.com/byu-magicc/roscopter)
* [ROSflight](https://github.com/rosflight/rosflight)
* [Magicc_sim](https://github.com/byu-magicc/magicc_sim)
* [ROSflight_plugins](https://github.com/byu-magicc/rosflight_plugins)
* [setpoint_publisher](https://github.com/uncc-visionlab/setpoint_publisher)

## How to Use

* Use the script in google_ee to collect Google Maps, SAR, NAIP, and Sentinel-2 images and generate a tar file to hold the model.

(The next portion takes place in `georegistration_testbed`)

* Place the images and tar file in a folder in the `models` directory and decompress the tar file.

* In `world_01.world` in the worlds folder, set the model to point to the directory where you placed the images,

    * Example: `<uri>model://FOLDER_NAME/</uri>`

* In the `fixedwing.launch` file from the `launch` directory:
    * Change the `ON_BOARD_REFERENCE_IMAGE` to the Google Maps image 
    * Change the `SENSOR_REFERENCE_IMAGE` to any of the downloaded images.
    * Change `MODEL_SIZE_X` to the size of the reference image in the x direction in meters.
    * Change `MODEL_SIZE_Y` to the size of the reference image in the y direction in meters. 

    * If using any of the opencv feature feature detector algorithms:
        * Change `DETECTOR_ALGORTIHM` and `EXTRACTOR_ALGORITHM` to one of the available OpenCV algorithms:

            * Detector:
                * ORB
                * GFTT
                * FAST
                * BRISK
                * SURF
                * SIFT
            * Extractor
                * ORB
                * SURF
                * SIFT
                * BRISK
                * BOOST

* To change between the mutual information, normalized cross-correlation, and OpenCV algorithms:
    * Change `self.ALGORITHM` in image_registration_node.py from `src/registration` to one of the algorithms.
    
Once everything is setup, you can launch the simulator by calling:

`roslaunch georegistration_testbed fixedwing.launch`.
